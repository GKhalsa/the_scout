class WalmartItemRepo

  def self.service
    WalmartService.new
  end

  def self.amazon_service
    AmazonService.new
  end

  def self.all
    WalmartCategoryRepo.category_ids.map do |category_id|
      full_item_hash = service.get_items({ category: category_id })
      item_grabber(full_item_hash)
    end.flatten!
  end

  def self.item_grabber(full_item_hash)
    items = []
    items << full_item_hash[:items]
    1.times do
      temp_item_hash = full_item_hash
      new_hash       = service.get_next_item_page(temp_item_hash[:nextPage])
      items          << new_hash[:items]
      full_item_hash = new_hash
    end
    items
  end

  def self.item_storage
    x = [{:itemId=>3919, :parentItemId=>3919, :name=>"Bell Sports Triple-Back 3-Bike Rack", :msrp=>60.13, :salePrice=>52.08, :upc=>"035011061689", :categoryPath=>"Auto & Tires/Exterior Car Accessories/Cargo Management System", :shortDescription=>"The Bell Sports Triple-Back 3-Bike Rack transports multiple bikes easily and safely. It is an ideal solution for hatchbacks, minivans and sport utility vehicles. This Bell Sports Bike Rack hauls three bikes securely on the back of your vehicle and features a rugged steel construction designed to keep your bikes safe. This Bell Triple-Back Bike Rack also has a patented, adjustable hub for a custom fit and a stable four-strap design that was created to keep your bikes from moving. When not in use, this 3-Bike Rack folds flat for easy storage.", :longDescription=>"&lt;b&gt;Bell Sports Triple-Bike 3-Bike Rack:&lt;/b&gt;&lt;ul&gt;&lt;li&gt;Patented, adjustable hubs for custom fit&lt;/li&gt;&lt;li&gt;Rugged steel construction&lt;/li&gt;&lt;li&gt;Stable, 4-strap design holds 3 bikes securely&lt;/li&gt;&lt;li&gt;Mini bike blocks with integrated tie-downs add stability&lt;/li&gt;&lt;li&gt;Folds flat for easy storage&lt;/li&gt;&lt;/ul&gt;", :brandName=>"Meade Instruments", :thumbnailImage=>"http://i5.walmartimages.com/dfw/dce07b8c-83af/k2-_3639e297-f858-466e-9a50-13552290892d.v1.jpg", :mediumImage=>"http://i5.walmartimages.com/dfw/dce07b8c-c805/k2-_29606869-2b79-4efd-8cce-b7c25f37e67b.v1.jpg", :largeImage=>"http://i5.walmartimages.com/dfw/dce07b8c-ef2d/k2-_957d8dc8-3fad-412d-af81-25e3ff570292.v1.jpg", :productTrackingUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FBell-Sports-Triple-Back-3-Bike-Rack%252F3919%253Faffp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :ninetySevenCentShipping=>false, :standardShipRate=>0.0, :twoThreeDayShippingRate=>15.27, :overnightShippingRate=>22.99, :marketplace=>false, :shipToStore=>false, :freeShipToStore=>false, :modelNumber=>"1006884", :productUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FBell-Sports-Triple-Back-3-Bike-Rack%2F3919%3Faffp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :customerRating=>"4.207", :numReviews=>28, :customerRatingImage=>"http://i2.walmartimages.com/i/CustRating/4_2.gif", :categoryNode=>"91083_1074784_1072103", :bundle=>false, :clearance=>false, :preOrder=>false, :stock=>"Not available", :addToCartUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D3919%7C1%26affp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :affiliateAddToCartUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D3919%257C1%2526affp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :freeShippingOver50Dollars=>true, :availableOnline=>false}, {:itemId=>3974, :parentItemId=>3974, :name=>"Turtle Wax Zip Wax Car Wash", :msrp=>5.87, :salePrice=>5.27, :upc=>"074660110782", :categoryPath=>"Auto & Tires/Auto Detailing & Car Care/Exterior Care/Car Washes & Cleaners", :shortDescription=>"Keep your ride looking good with the Zip Wax Car Wash. It uses an advanced sudsing action that lifts dirt and grime effortlessly. The product is streak-free and does not leave spots. The Turtle Wax car wash is safe for all finishes and comes in a 1-gallon size. Use it to keep your vehicle looking sparkly and clean.", :longDescription=>"&lt;p&gt;&lt;b&gt;Turtle Wax Zip Wax Car Wash:&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Advanced sudsing action gently and safely lifts dirt and grime&lt;/li&gt;&lt;li&gt;No-streak formula&lt;/li&gt;&lt;li&gt;Leaves no spots&lt;/li&gt;&lt;li&gt;Won't strip wax&lt;/li&gt;&lt;li&gt;The car wash and wax is safe for all for finishes&lt;/li&gt;&lt;li&gt;1 gallon&lt;/li&gt;&lt;/ul&gt;", :brandName=>"Turtle Wax", :thumbnailImage=>"http://i5.walmartimages.com/dfw/dce07b8c-cd59/k2-_7176234c-30b9-4559-aebc-58dd6b8cec0d.v1.jpg", :mediumImage=>"http://i5.walmartimages.com/dfw/dce07b8c-58e0/k2-_38e70fa6-e777-4caf-abe4-adb8f5be1711.v1.jpg", :largeImage=>"http://i5.walmartimages.com/dfw/dce07b8c-c38a/k2-_5b18fed1-59c1-4b5f-96cc-5667dff07eb8.v1.jpg", :productTrackingUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FTurtle-Wax-Zip-Wax-Car-Wash%252F3974%253Faffp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :ninetySevenCentShipping=>false, :standardShipRate=>4.97, :twoThreeDayShippingRate=>8.77, :overnightShippingRate=>15.07, :marketplace=>false, :shipToStore=>true, :freeShipToStore=>true, :modelNumber=>"T78", :productUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FTurtle-Wax-Zip-Wax-Car-Wash%2F3974%3Faffp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :customerRating=>"3.563", :numReviews=>13, :customerRatingImage=>"http://i2.walmartimages.com/i/CustRating/3_6.gif", :categoryNode=>"91083_1212910_1212911", :bundle=>false, :clearance=>false, :preOrder=>false, :stock=>"Available", :addToCartUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D3974%7C1%26affp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :affiliateAddToCartUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D3974%257C1%2526affp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :freeShippingOver50Dollars=>true, :availableOnline=>true}, {:itemId=>3975, :parentItemId=>3975, :name=>"Reed-Union NF-76 Nu Finish Car Polish-LIQUID CAR POLISH", :msrp=>14.29, :salePrice=>12.15, :upc=>"078161000061", :categoryPath=>"Auto & Tires/Auto Detailing & Car Care/Exterior Care/Car Wax & Polish", :shortDescription=>"Nu Finish&trade; is the once-a-year car polish that independent tests have proven will bead, shine and protect for a whole year...even after 52 automatic car washes.", :longDescription=>"Once-a-year car polish. Contains no wax. Can be applied in direct sunlight. More than 5 times the protection of conventional wax. Super-soft for easy application. PackageTypeDescription", :brandName=>"Nu Finish", :thumbnailImage=>"http://i5.walmartimages.com/dfw/dce07b8c-f5bc/k2-_98df9fd9-c2e0-405d-ac3e-b1f7fee63a3f.v2.jpg", :mediumImage=>"http://i5.walmartimages.com/dfw/dce07b8c-f977/k2-_b1197737-2e5d-4469-873c-f56ca956e315.v2.jpg", :largeImage=>"http://i5.walmartimages.com/dfw/dce07b8c-a929/k2-_8017bd2f-44b6-47a9-a342-82dd001fac99.v2.jpg", :productTrackingUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FNu-Finish-8482-Car-Polish%252F3975%253Faffp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :standardShipRate=>0.0, :color=>"Multicolor", :marketplace=>true, :modelNumber=>"NF-76", :sellerInfo=>"Bic Supply LLC", :productUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FNu-Finish-8482-Car-Polish%2F3975%3Faffp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :customerRating=>"5.0", :numReviews=>1, :customerRatingImage=>"http://i2.walmartimages.com/i/CustRating/5.gif", :categoryNode=>"91083_1212910_1212911", :bundle=>false, :clearance=>true, :preOrder=>false, :stock=>"Available", :addToCartUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D3975%7C1%26affp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :affiliateAddToCartUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D3975%257C1%2526affp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :freeShippingOver50Dollars=>false, :availableOnline=>true}, {:itemId=>3976, :parentItemId=>3976, :name=>"Mothers Polish 5701 CA. Gold Original Cleaner Wax - Liquid", :msrp=>7.97, :salePrice=>5.99, :upc=>"078175057013", :categoryPath=>"Auto & Tires/Auto Detailing & Car Care/Exterior Care/Car Washes & Cleaners", :shortDescription=>"Enjoy the convenience of this easy-to-use one-step cleaner wax. Made with genuine Brazilian carnauba wax.", :longDescription=>"&lt;ul&gt;&lt;li&gt;Removes oxidation&lt;/li&gt;&lt;li&gt;Restores color&lt;/li&gt;&lt;li&gt;Provides long-lasting shine and protection&lt;/li&gt;&lt;li&gt;Also works well on fiberglass and gel coat&lt;/li&gt;&lt;/ul&gt;", :brandName=>"Mothers", :thumbnailImage=>"http://i5.walmartimages.com/dfw/dce07b8c-7442/k2-_e9bbc139-23b6-4c28-b021-c989645e6dc2.v1.jpg", :mediumImage=>"http://i5.walmartimages.com/dfw/dce07b8c-7033/k2-_dd5adae4-bda6-49fb-ac34-f3b844237f47.v1.jpg", :largeImage=>"http://i5.walmartimages.com/dfw/dce07b8c-c4f7/k2-_b6c1438a-5f0c-4372-982e-e7fb4aa68c4a.v1.jpg", :productTrackingUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FMothers-Polish-5701-CA.-Gold-Original-Cleaner-Wax-Liquid%252F3976%253Faffp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :ninetySevenCentShipping=>false, :standardShipRate=>4.97, :twoThreeDayShippingRate=>6.95, :overnightShippingRate=>12.02, :color=>"Multicolor", :marketplace=>false, :shipToStore=>true, :freeShipToStore=>true, :modelNumber=>"5701", :productUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FMothers-Polish-5701-CA.-Gold-Original-Cleaner-Wax-Liquid%2F3976%3Faffp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :customerRating=>"5.0", :numReviews=>3, :customerRatingImage=>"http://i2.walmartimages.com/i/CustRating/5.gif", :bestMarketplacePrice=>{:price=>12.47, :sellerInfo=>"Bic Supply LLC", :standardShipRate=>0.0, :availableOnline=>true, :clearance=>true}, :categoryNode=>"91083_1212910_1212911", :bundle=>false, :clearance=>false, :preOrder=>false, :stock=>"Available", :addToCartUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D3976%7C1%26affp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :affiliateAddToCartUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D3976%257C1%2526affp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :freeShippingOver50Dollars=>true, :availableOnline=>true}, {:itemId=>3980, :parentItemId=>3980, :name=>"Turtle Wax T79 Zip Wax  Car Wash-64OZ LIQUID CAR WASH", :msrp=>15.66, :salePrice=>13.22, :upc=>"074660010792", :categoryPath=>"Auto & Tires/Auto Detailing & Car Care/Exterior Care/Car Washes & Cleaners", :longDescription=>"Advanced sudsing action lifts dirt and grime. Has rich, mild, deep-cleaning suds that will not harm car finishes and it adds a shine as it washes. PackageTypeDescription", :brandName=>"Turtle Wax", :thumbnailImage=>"http://i5.walmartimages.com/dfw/dce07b8c-261b/k2-_8e9e745e-1362-42a3-bc42-0eac5d17b132.v2.jpg", :mediumImage=>"http://i5.walmartimages.com/dfw/dce07b8c-edf0/k2-_a99b604e-2537-46f5-91b9-6682a8a74d46.v2.jpg", :largeImage=>"http://i5.walmartimages.com/dfw/dce07b8c-cfe0/k2-_af39c4fc-2d7d-4df8-9f54-8b0e08c8db7f.v2.jpg", :productTrackingUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FZip-Wax-car-wash%252F3980%253Faffp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :standardShipRate=>0.0, :color=>"Multicolor", :marketplace=>true, :modelNumber=>"T79", :sellerInfo=>"Bic Supply LLC", :productUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FZip-Wax-car-wash%2F3980%3Faffp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :customerRating=>"2.6", :numReviews=>3, :customerRatingImage=>"http://i2.walmartimages.com/i/CustRating/2_6.gif", :categoryNode=>"91083_1212910_1212911", :bundle=>false, :clearance=>true, :preOrder=>false, :stock=>"Available", :addToCartUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D3980%7C1%26affp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :affiliateAddToCartUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D3980%257C1%2526affp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :freeShippingOver50Dollars=>false, :availableOnline=>true}, {:itemId=>3996, :parentItemId=>3996, :name=>"12V 250PSI INFLATOR", :salePrice=>29.55, :upc=>"045564100698", :categoryPath=>"Auto & Tires/Tires/Tubes & Tire Accessories", :shortDescription=>"Campbell Hausfeld RP1200 12-Volt 250-PSI Inflator 12 Volt Each", :longDescription=>"&lt;br&gt;&quot; Great for emergency roadside tire inflation&lt;br&gt;&quot; Inflates car tires, bike tires, beach balls, footballs and other recreational equipment&lt;br&gt;&quot; Plugs into car cigarette lighter, includes 2 inflation accessories and universal adapter&lt;br&gt;&quot; 250 PSI maximum&lt;br&gt;&quot; bike tires beach balls footballs and other recreational equipment&lt;br&gt;&quot; Plugs into car cigarette lighter includes 2 inflation accessories and universal adapter&lt;br&gt;&quot; 250 PSI maximum.", :brandName=>"Campbell Hausfeld", :thumbnailImage=>"http://i5.walmartimages.com/dfw/dce07b8c-137d/k2-_4e96cd0c-9dd8-4468-a95e-edff50862e85.v1.jpg", :mediumImage=>"http://i5.walmartimages.com/dfw/dce07b8c-68ca/k2-_89574fb0-cf08-429f-aa74-8e7f7d3675af.v1.jpg", :largeImage=>"http://i5.walmartimages.com/dfw/dce07b8c-f677/k2-_a15f97a6-3b5c-4450-896b-a0e3bb8d3c32.v1.jpg", :productTrackingUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FCampbell-Hausfeld-12-volt-250-PSI-Inflator%252F3996%253Faffp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :standardShipRate=>7.59, :twoThreeDayShippingRate=>37.6, :color=>"Multicolor", :marketplace=>true, :modelNumber=>"RP1200", :productUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FCampbell-Hausfeld-12-volt-250-PSI-Inflator%2F3996%3Faffp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :categoryNode=>"91083", :bundle=>false, :clearance=>false, :stock=>"Not available", :addToCartUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D3996%7C1%26affp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :affiliateAddToCartUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D3996%257C1%2526affp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :freeShippingOver50Dollars=>false, :availableOnline=>false}, {:itemId=>4006, :parentItemId=>4006, :name=>"Turtle Wax&#174; Super Hard Shell Paste Wax", :salePrice=>3.92, :upc=>"074660012222", :categoryPath=>"Auto & Tires/Auto Detailing & Car Care/Exterior Care/Car Wax & Polish", :shortDescription=>"Give your vehicle a beautiful, long-lasting luster! This easy on / easy off paste wax lasts up to 12 months!", :longDescription=>"Super Hard Shell&reg; paste wax from Turtle Wax&amp;#8482 gives your vehicle a beautiful, long-lasting luster. &lt;ul&gt;&lt;li&gt;Ideal for all car finishes&lt;/li&gt;&lt;li&gt;Great for metallics, conventional enamels and clear coat finishes&lt;/li&gt;&lt;li&gt;Easy on / off formula&lt;/li&gt;&lt;li&gt;Lasts up to 12 months&lt;/li&gt;&lt;li&gt;World's largest selling car wax&lt;/li&gt;&lt;li&gt;14 oz.&lt;/li&gt;&lt;/ul&gt;", :brandName=>"Turtle Wax", :thumbnailImage=>"http://i5.walmartimages.com/dfw/dce07b8c-3637/k2-_b4fae504-f7bf-4d42-b243-9ceb2690c1dd.v1.jpg", :mediumImage=>"http://i5.walmartimages.com/dfw/dce07b8c-6206/k2-_83c5f6ef-364f-4380-87d0-ff2287e1e09a.v1.jpg", :largeImage=>"http://i5.walmartimages.com/dfw/dce07b8c-3cd3/k2-_b873778d-ee5c-4e88-8173-a20f1d937e5f.v1.jpg", :productTrackingUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FSuper-Hard-Shell-174-paste-wax%252F4006%253Faffp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :ninetySevenCentShipping=>false, :standardShipRate=>4.97, :twoThreeDayShippingRate=>10.16, :overnightShippingRate=>17.22, :color=>"Multicolor", :marketplace=>false, :shipToStore=>false, :freeShipToStore=>false, :modelNumber=>"T222R", :productUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FSuper-Hard-Shell-174-paste-wax%2F4006%3Faffp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :customerRating=>"4.25", :numReviews=>12, :customerRatingImage=>"http://i2.walmartimages.com/i/CustRating/4_3.gif", :categoryNode=>"91083_1212910_1212911", :bundle=>false, :clearance=>false, :preOrder=>false, :stock=>"Available", :addToCartUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D4006%7C1%26affp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :affiliateAddToCartUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D4006%257C1%2526affp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :freeShippingOver50Dollars=>true, :availableOnline=>true}, {:itemId=>4012, :parentItemId=>4012, :name=>"Turtle Wax Zymol Cleaner Wax", :msrp=>12.97, :salePrice=>9.15, :upc=>"074660015032", :categoryPath=>"Auto & Tires/Auto Detailing & Car Care/Exterior Care/Car Washes & Cleaners", :shortDescription=>"Give your vehicle a superior mirror finish for a brand-new look! This one-step product offers you both convenience and performance! Turtle Wax Zymol Cleaner Wax is the No. 1 rated car polish that's pure, powerful, perfect.", :longDescription=>"&lt;p&gt;&lt;b&gt;Turtle Wax Zymol Cleaner Wax:&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Unique one-step product&lt;/li&gt;&lt;li&gt;Derived from 120-year-old German formula&lt;/li&gt;&lt;li&gt;Formulated with natural, active ingredients&lt;/li&gt;&lt;li&gt;Safely removes swirl marks and mild oxidation&lt;/li&gt;&lt;li&gt;Provides a deep, brilliant, mirror-like shine&lt;/li&gt;&lt;li&gt;Safe for all finishes&lt;/li&gt;&lt;li&gt;16 oz.&lt;/li&gt;&lt;/ul&gt;", :brandName=>"Zymol", :thumbnailImage=>"http://i5.walmartimages.com/dfw/dce07b8c-be88/k2-_10797aeb-99be-4372-b630-bcc08668a694.v1.jpg", :mediumImage=>"http://i5.walmartimages.com/dfw/dce07b8c-6316/k2-_12a99124-954c-4a60-b787-056151e9ff64.v1.jpg", :largeImage=>"http://i5.walmartimages.com/dfw/dce07b8c-5af3/k2-_0b770ef3-6397-48ec-8c0a-e0896cc5781d.v1.jpg", :productTrackingUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FZymol-cleaner-wax%252F4012%253Faffp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :ninetySevenCentShipping=>false, :standardShipRate=>4.97, :twoThreeDayShippingRate=>6.95, :overnightShippingRate=>12.02, :color=>"Multicolor", :marketplace=>false, :shipToStore=>true, :freeShipToStore=>true, :modelNumber=>"Z503A", :productUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FZymol-cleaner-wax%2F4012%3Faffp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :customerRating=>"5.0", :customerRatingImage=>"http://i2.walmartimages.com/i/CustRating/5.gif", :bestMarketplacePrice=>{:price=>22.82, :sellerInfo=>"Direct Home Supplies", :standardShipRate=>7.99, :twoThreeDayShippingRate=>38.0, :availableOnline=>true, :clearance=>false}, :categoryNode=>"91083_1212910_1212911", :bundle=>false, :clearance=>false, :preOrder=>false, :stock=>"Available", :addToCartUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D4012%7C1%26affp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :affiliateAddToCartUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D4012%257C1%2526affp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :freeShippingOver50Dollars=>true, :availableOnline=>true}, {:itemId=>4016, :parentItemId=>4016, :name=>"Campa Chem Liquid Holding Tank Deodorant, 6-Pack", :salePrice=>7.34, :upc=>"028985132882", :categoryPath=>"Auto & Tires/RV/All RV Accessories", :shortDescription=>"This 6-pack of 8-ounce bottles of liquid holding tank deodorant delivers strong odor control, breaks down waste, keeps the holding tank clean and is 100% biodegradable.", :longDescription=>"This item contains &lt;span class=&quot;text2bold&quot;&gt;regulated materials&lt;/span&gt; and is available only via Ground shipping, which takes up to 8 business days (We're sorry, Priority and Express shipping are not available for this item). &lt;a href=&quot;/cservice/ca_shippingreturns.gsp&quot;&gt;Read more about Shipping &amp; Returns&lt;/a&gt;&lt;p&gt;Features:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Strong odor control&lt;/li&gt;&lt;li&gt;Breaks down waste&lt;/li&gt;&lt;li&gt;Keeps holding tanks clean&lt;/li&gt;&lt;li&gt;100% biodegradable&lt;/li&gt;&lt;/ul&gt;", :brandName=>"Campa Chem", :thumbnailImage=>"http://i5.walmartimages.com/dfw/dce07b8c-a37e/k2-_9ca4c512-3c6c-4edd-830d-f5c024b01fb1.v1.jpg", :mediumImage=>"http://i5.walmartimages.com/dfw/dce07b8c-213c/k2-_27506fea-6acd-45b6-a763-95e69cb5b860.v1.jpg", :largeImage=>"http://i5.walmartimages.com/dfw/dce07b8c-1dba/k2-_0efcda6e-36c8-4182-8659-28790ef2d9f9.v1.jpg", :productTrackingUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FCampa-Chem-Liquid-Holding-Tank-Deodorant-6-Pack%252F4016%253Faffp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :ninetySevenCentShipping=>false, :standardShipRate=>4.97, :marketplace=>false, :shipToStore=>true, :freeShipToStore=>true, :modelNumber=>"13288", :productUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FCampa-Chem-Liquid-Holding-Tank-Deodorant-6-Pack%2F4016%3Faffp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :customerRating=>"4.9", :numReviews=>9, :customerRatingImage=>"http://i2.walmartimages.com/i/CustRating/4_9.gif", :categoryNode=>"91083_2983678_1070265", :bundle=>false, :clearance=>false, :preOrder=>false, :stock=>"Available", :addToCartUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D4016%7C1%26affp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :affiliateAddToCartUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D4016%257C1%2526affp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :freeShippingOver50Dollars=>true, :availableOnline=>true}, {:itemId=>870631, :parentItemId=>870631, :name=>"Meguiar's Quik Detailer", :salePrice=>5.17, :upc=>"070382133160", :categoryPath=>"Auto & Tires/Auto Detailing & Car Care/Exterior Care/Car Washes & Cleaners", :shortDescription=>"&lt;p&gt;Meguiar's Quik Detailer has been a favorite of car enthusiasts for years. This detailer keeps a waxed car looking &quot;just waxed.&quot; It helps you show off your car with pride. It is clear-coat safe and easy to use. Meguiar's detailer removes harmful contaminants before they can do any damage to your car's finish. Spray some on and wipe off right after your car is exposed to any other condition that ruins your polished appearance. Keep it handy in your car or garage for an instant fix. The safe, high-lubricity formula lifts off dirt and grime without scratching while enhancing gloss without buildup. Make your car the envy of all who cast their eyes on it. You can shine a full-sized car in less than 15 minutes with this high-quality car detailer. It provides all you need to keep up the attractive shine and make the vibrant color of your vehicle pop./p&gt;&lt;/p&gt;", :longDescription=>"&lt;p&gt;&lt;b&gt;Meguiar's Quik Detailer:&lt;/b&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Removes harmful contaminants before they damage your paint finish&lt;/li&gt;&lt;li&gt;Meguiar's detailer keeps a waxed car looking &quot;just waxed&quot;&lt;/li&gt;&lt;li&gt;Safe, high-lubricity formula&lt;/li&gt;&lt;li&gt;Details a full-sized car in less than 15 minutes&lt;/li&gt;&lt;li&gt;Model# A3316&lt;/li&gt;&lt;/ul&gt;", :brandName=>"Meguiar's", :thumbnailImage=>"http://i5.walmartimages.com/dfw/dce07b8c-f3f4/k2-_df81870c-15a5-4065-aed3-707d6f54f479.v1.jpg", :mediumImage=>"http://i5.walmartimages.com/dfw/dce07b8c-6f86/k2-_330f3fb5-a65a-459f-88f2-5512813bd642.v1.jpg", :largeImage=>"http://i5.walmartimages.com/dfw/dce07b8c-8f25/k2-_3fe49a64-703c-46dd-a5d2-2d365e60b0dc.v1.jpg", :productTrackingUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Fwww.walmart.com%252Fip%252FMeguiar-s-Quik-Detailer%252F870631%253Faffp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :ninetySevenCentShipping=>false, :standardShipRate=>4.97, :twoThreeDayShippingRate=>6.47, :overnightShippingRate=>10.96, :color=>"Multicolor", :marketplace=>false, :shipToStore=>true, :freeShipToStore=>true, :modelNumber=>"A3316", :productUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Fwww.walmart.com%2Fip%2FMeguiar-s-Quik-Detailer%2F870631%3Faffp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :customerRating=>"5.0", :numReviews=>4, :customerRatingImage=>"http://i2.walmartimages.com/i/CustRating/5.gif", :bestMarketplacePrice=>{:price=>6.4, :sellerInfo=>"JB Tool Sales", :standardShipRate=>5.87, :availableOnline=>true, :clearance=>false}, :categoryNode=>"91083_1212910_1212911", :bundle=>false, :clearance=>false, :preOrder=>false, :stock=>"Available", :addToCartUrl=>"http://c.affil.walmart.com/t/api01?l=http%3A%2F%2Faffil.walmart.com%2Fcart%2FaddToCart%3Fitems%3D870631%7C1%26affp1%3DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%26affilsrc%3Dapi%26veh%3Daff%26wmlspartner%3Dreadonlyapi", :affiliateAddToCartUrl=>"http://linksynergy.walmart.com/fs-bin/click?id=|LSNID|&offerid=223073.7200&type=14&catid=8&subid=0&hid=7200&tmpid=1082&RD_PARM1=http%253A%252F%252Faffil.walmart.com%252Fcart%252FaddToCart%253Fitems%253D870631%257C1%2526affp1%253DaW3yUPyKIrBLI6e64gNOpRsZrT_8TFwWYjuPM7Jfw6M%2526affilsrc%253Dapi", :freeShippingOver50Dollars=>true, :availableOnline=>true}]

    x.each do |item|
    # all.each do |item|
      raw_params = item
      params = ActionController::Parameters.new(raw_params)
      Item.create(params.permit(:name, :salePrice, :upc, :stock, :availableOnline))
    end
  end
  #extract like permited params, slice

  # def self.gather_amazon_attributes
  #   items = []
  #   upcs = []
  #   num = 9
  #   Item.all.each_with_index do |item, index|  #map with index
  #     if index <= num
  #       items << item
  #       upcs << item.upc
  #       if index == num
  #         upcs_for_api_call = upcs.join(",")
  #         amazon_items, a,b,c,d = amazon_service.get_items(upcs_for_api_call)
  #         pair_items(amazon_items, items)
  #         items = []
  #         upcs = []
  #         num += 10
  #       end
  #     end
  #   end
  # end

  def self.gather_amazon_hashes
    items = []
    upcs = []
    num = 9
    Item.all.each_with_index do |item, index|  #map with index
      if index <= num
        items << item
        upcs << item.upc
        if index == num
          upcs_for_api_call = upcs.join(",")
          amazon_hashes = amazon_service.get_items(upcs_for_api_call)
          create_amazon_items(amazon_hashes)
          items = []
          upcs = []
          num += 10
        end
      end
    end
  end

  def self.add_amazon_data_to_walmart_item
    Item.all.each do |item|
      amazon_attributes = AmazonItem.all.find do |amazon_item|
        (amazon_item.upc == item.upc) && (amazon_item.prime == "1") && (!amazon_item.url.include?("Pack"))
      end

      unless amazon_attributes.nil?
            item.update(
                   amazon_url: amazon_attributes.url,
          lowest_amazon_price: amazon_attributes.lowest_new_price,
                 quantity_new: amazon_attributes.quantity_new,
                    salesrank: amazon_attributes.sales_rank
                        )
      end
    end
  end

  def self.create_amazon_items(amazon_hashes)
      amazon_hashes.each do |hash|
        begin
          AmazonItem.create(
                           url: hash["DetailPageURL"],
              lowest_new_price: hash["OfferSummary"]["LowestNewPrice"]["Amount"],
                  quantity_new: hash["OfferSummary"]["TotalNew"],
                    sales_rank: hash["SalesRank"],
                           upc: hash["ItemAttributes"]["UPC"],
                         prime: hash["Offers"]["Offer"]["OfferListing"]["IsEligibleForPrime"]
                           )
        rescue
      end
    end
  end


  # def self.temp
  #   a = Item.all.take(1).map do |item|
  #     amazon_service.get_items(item.upc)
  #   end
  #   binding.pry
  #   pair_items(a, Item.all)
  # end

  # def self.temp
  #   a = Item.all.take(1).map do |item|
  #     # amazon_service.get_item("074660015032")
  #     amazon_service.get_item("B00YFZF0H4")
  #   end
  #   binding.pry
  #   pair_items(a, Item.all)
  # end

  # def self.filter_amazon_items
  #
  # end

  # def self.pair_items(amazon_items, items)
  #   items.each_with_index do |item, index|
  #     if amazon_items[index] != nil
  #       if amazon_items[index].is_a?(Array)
  #         item.update(
  #                       amazon_url: amazon_items[index].first["DetailPageURL"],
  #              lowest_amazon_price: amazon_items[index].first["OfferSummary"]["LowestNewPrice"]["Amount"],
  #                     quantity_new: amazon_items[index].first["OfferSummary"]["TotalNew"],
  #                        salesrank: amazon_items[index].first["SalesRank"]
  #                     )
  #       elsif amazon_items[index].is_a?(Hash)
  #         item.update(
  #                      amazon_url: amazon_items[index]["DetailPageURL"],
  #             lowest_amazon_price: amazon_items[index]["OfferSummary"]["LowestNewPrice"]["Amount"],
  #                    quantity_new: amazon_items[index]["OfferSummary"]["TotalNew"],
  #                       salesrank: amazon_items[index]["SalesRank"]
  #         )
  #       end
  #     end
  #   end
  # end
end
